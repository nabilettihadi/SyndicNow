<app-navbar></app-navbar>

<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card shadow">
        <div class="card-body">
          <h2 class="card-title mb-4">{{ isEditMode ? 'Modifier' : 'Ajouter' }} un immeuble</h2>

          <div *ngIf="loading" class="text-center my-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Chargement...</span>
            </div>
          </div>

          <div *ngIf="error" class="alert alert-danger">
            <i class="fas fa-exclamation-circle me-2"></i>
            {{ error }}
          </div>

          <form [formGroup]="immeubleForm" (ngSubmit)="onSubmit()" *ngIf="!loading" class="needs-validation">
            <div class="mb-4">
              <label for="nom" class="form-label">Nom de l'immeuble *</label>
              <div class="input-group">
                <span class="input-group-text"><i class="fas fa-building"></i></span>
                <input type="text" class="form-control" id="nom" formControlName="nom"
                  [class.is-invalid]="immeubleForm.get('nom')?.errors?.['required'] && immeubleForm.get('nom')?.touched">
              </div>
              <div class="invalid-feedback" *ngIf="immeubleForm.get('nom')?.errors?.['required'] && immeubleForm.get('nom')?.touched">
                Le nom est requis
              </div>
            </div>

            <div class="mb-4">
              <label for="adresse" class="form-label">Adresse *</label>
              <div class="input-group">
                <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                <input type="text" class="form-control" id="adresse" formControlName="adresse"
                  [class.is-invalid]="immeubleForm.get('adresse')?.errors?.['required'] && immeubleForm.get('adresse')?.touched">
              </div>
              <div class="invalid-feedback" *ngIf="immeubleForm.get('adresse')?.errors?.['required'] && immeubleForm.get('adresse')?.touched">
                L'adresse est requise
              </div>
            </div>

            <div class="row mb-4">
              <div class="col-md-6">
                <label for="codePostal" class="form-label">Code Postal *</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-map"></i></span>
                  <input type="text" class="form-control" id="codePostal" formControlName="codePostal"
                    [class.is-invalid]="immeubleForm.get('codePostal')?.errors?.['required'] && immeubleForm.get('codePostal')?.touched">
                </div>
                <div class="invalid-feedback" *ngIf="immeubleForm.get('codePostal')?.errors?.['required'] && immeubleForm.get('codePostal')?.touched">
                  Le code postal est requis
                </div>
              </div>

              <div class="col-md-6">
                <label for="ville" class="form-label">Ville *</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-city"></i></span>
                  <input type="text" class="form-control" id="ville" formControlName="ville"
                    [class.is-invalid]="immeubleForm.get('ville')?.errors?.['required'] && immeubleForm.get('ville')?.touched">
                </div>
                <div class="invalid-feedback" *ngIf="immeubleForm.get('ville')?.errors?.['required'] && immeubleForm.get('ville')?.touched">
                  La ville est requise
                </div>
              </div>
            </div>

            <div class="row mb-4">
              <div class="col-md-4">
                <label for="nombreEtages" class="form-label">Nombre d'étages *</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-layer-group"></i></span>
                  <input type="number" class="form-control" id="nombreEtages" formControlName="nombreEtages" min="1"
                    [class.is-invalid]="immeubleForm.get('nombreEtages')?.errors?.['required'] && immeubleForm.get('nombreEtages')?.touched">
                </div>
                <div class="invalid-feedback" *ngIf="immeubleForm.get('nombreEtages')?.errors?.['required'] && immeubleForm.get('nombreEtages')?.touched">
                  Le nombre d'étages est requis
                </div>
              </div>

              <div class="col-md-4">
                <label for="nombreAppartements" class="form-label">Nombre d'appartements *</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-door-open"></i></span>
                  <input type="number" class="form-control" id="nombreAppartements" formControlName="nombreAppartements" min="1"
                    [class.is-invalid]="immeubleForm.get('nombreAppartements')?.errors?.['required'] && immeubleForm.get('nombreAppartements')?.touched">
                </div>
                <div class="invalid-feedback" *ngIf="immeubleForm.get('nombreAppartements')?.errors?.['required'] && immeubleForm.get('nombreAppartements')?.touched">
                  Le nombre d'appartements est requis
                </div>
              </div>

              <div class="col-md-4">
                <label for="anneeConstruction" class="form-label">Année de construction *</label>
                <div class="input-group">
                  <span class="input-group-text"><i class="fas fa-calendar-alt"></i></span>
                  <input type="number" class="form-control" id="anneeConstruction" formControlName="anneeConstruction"
                    [class.is-invalid]="immeubleForm.get('anneeConstruction')?.errors?.['required'] && immeubleForm.get('anneeConstruction')?.touched">
                </div>
                <div class="invalid-feedback" *ngIf="immeubleForm.get('anneeConstruction')?.errors?.['required'] && immeubleForm.get('anneeConstruction')?.touched">
                  L'année de construction est requise
                </div>
              </div>
            </div>

            <div class="d-flex gap-2 justify-content-end">
              <button type="button" class="btn btn-outline-secondary" routerLink="/immeubles">
                <i class="fas fa-times me-2"></i>Annuler
              </button>
              <button type="submit" class="btn btn-primary" [disabled]="!immeubleForm.valid || loading">
                <i class="fas fa-save me-2"></i>{{ isEditMode ? 'Modifier' : 'Ajouter' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div> 